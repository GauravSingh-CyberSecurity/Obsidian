https://tryhackme.com/room/nahamstore



here we create two or more user id and try to change the `id=`  parameter to see if we can get another access to another users data, or perform action as other users.




---
1
00:00:00,120 --> 00:00:05,820
So it comes down to looking for either the biggest thing to understand is what does this company find

2
00:00:05,820 --> 00:00:08,930
valuable as far as the customers information go?

3
00:00:09,270 --> 00:00:14,460
So, for example, if you go to orders, what kind of information does this module or this functionality

4
00:00:14,700 --> 00:00:20,820
store, if you go to address book, what does it look like if it's showing the actual first name, last

5
00:00:20,820 --> 00:00:21,990
name and then the address?

6
00:00:22,320 --> 00:00:23,550
That's kind of PII.

7
00:00:23,550 --> 00:00:27,480
It's private information that's helping us identify the individual.

8
00:00:27,750 --> 00:00:32,070
Those are very, very important to customers and companies.

9
00:00:32,280 --> 00:00:34,110
So you want to make sure you target those first.

10
00:00:34,980 --> 00:00:41,430
It's one of the all the best pieces of advice I can give you when it comes down to finding IDOR vulnerabilities

11
00:00:41,430 --> 00:00:42,840
is to have two browsers open.

12
00:00:42,850 --> 00:00:47,310
So right here, as you can see, I have two browsers ready on the left side of my account.

13
00:00:47,640 --> 00:00:52,070
On the right side is another account that I've created that I'm calling my victim account.

14
00:00:52,080 --> 00:00:54,570
So on both of these, I have different information.

15
00:00:54,570 --> 00:00:59,700
Again, I understand that it's really hard to have real data on some of these programs because, for

16
00:00:59,700 --> 00:01:06,060
example, you to make an order that could be tricky if you don't know, that could be tricky if you

17
00:01:06,060 --> 00:01:09,840
don't want to spend money on your own, which I highly recommend spending money when it comes on to

18
00:01:10,440 --> 00:01:13,860
testing some of these things, because most people don't want to spend the money to test it out.

19
00:01:14,310 --> 00:01:15,890
But that's not the point here.

20
00:01:16,200 --> 00:01:20,080
==The biggest thing is I have two accounts and testing them against each other.==

21
00:01:20,100 --> 00:01:22,740
So on the left side, again, that's my real account.

22
00:01:22,980 --> 00:01:25,980
And on the right side is the account of a victim that I've created.

23
00:01:25,980 --> 00:01:30,250
I've already printed order on the website and I have an address in the address book.

24
00:01:30,660 --> 00:01:36,210
This helps me be able to make sure and confirm these things that I'm finding are actually valid and

25
00:01:36,210 --> 00:01:41,550
it belongs on the user without actually going after user data that belongs to a real person, especially

26
00:01:41,550 --> 00:01:45,000
if you're testing a site that's in PRAD where real data is stored.

27
00:01:45,060 --> 00:01:47,090
So again, I want to make it very, very clear.

28
00:01:47,370 --> 00:01:53,100
Do not ever go after a real customer data always with two accounts, and that will protect you and the

29
00:01:53,100 --> 00:01:57,450
company and you can make sure that you're not getting disqualified from receiving your bounty.

30
00:01:57,690 --> 00:02:00,660
So what I to to do is you can do this again in two different ways.

31
00:02:01,050 --> 00:02:05,490
One is to have the network tab right here open in your browser.

32
00:02:06,060 --> 00:02:06,810
That's the same thing.

33
00:02:06,810 --> 00:02:09,700
Or if you have access to birdseed, you can also do that as well.

34
00:02:09,720 --> 00:02:14,700
So on the left side, I'm just going to create a new test.

35
00:02:14,970 --> 00:02:18,330
I address my real address.

36
00:02:19,320 --> 00:02:26,280
We're going to put my state and we're going to give it one zero one zero, something fake for now just

37
00:02:26,280 --> 00:02:28,200
to have some data credit and then go right here.

38
00:02:28,620 --> 00:02:32,220
And we can see that is creating some stuff on the sites.

39
00:02:32,220 --> 00:02:33,700
I'm going to actually move it over.

40
00:02:33,720 --> 00:02:34,800
We're going to ignore the site.

41
00:02:35,220 --> 00:02:39,600
We're going to look at what the response looks like and what do we fetch.

42
00:02:39,630 --> 00:02:41,640
So we're fetching accounts of the address book.

43
00:02:41,940 --> 00:02:43,410
No numerical IDs there.

44
00:02:43,410 --> 00:02:46,890
We can't really change anything to see that the addresses.

45
00:02:46,890 --> 00:02:50,670
But let's go ahead and see if we can delete what happens if I delete it.

46
00:02:51,000 --> 00:02:56,010
So if we push delete, it's going to make another call that's going to do address book.

47
00:02:57,670 --> 00:03:00,030
It's not really giving me anything that I want to do here.

48
00:03:00,030 --> 00:03:01,170
There's a post request.

49
00:03:01,740 --> 00:03:02,490
We can scroll down.

50
00:03:02,490 --> 00:03:08,820
It says delete, just ID four so we can assume that there is other options before this.

51
00:03:08,820 --> 00:03:13,500
Number four, since I've already created this right before I started recording, I know that this is

52
00:03:13,890 --> 00:03:17,820
I just 83 and we can confirm this just really quickly by doing it.

53
00:03:17,820 --> 00:03:23,370
And if I delete this address specifically, I just eighty-three I'm going to drop it to make sure this

54
00:03:23,370 --> 00:03:25,940
doesn't go through so we can test our ideas.

55
00:03:25,950 --> 00:03:28,950
If I go back, I just go there.

56
00:03:29,950 --> 00:03:32,100
What are we going to do is we're going to ignore this right side.

57
00:03:32,100 --> 00:03:35,550
This is our target account that we're going to go after.

58
00:03:35,940 --> 00:03:42,030
But what I'm going to do is I'm going to create another test address.

59
00:03:47,270 --> 00:03:48,350
Once that is created.

60
00:03:50,260 --> 00:03:55,060
I'm going to open up Bourbon Street, I'm going to intercept and with Bourbon Street now open, we're

61
00:03:55,060 --> 00:03:59,020
going to delete this address and we're going to send it to repeater.

62
00:03:59,710 --> 00:04:03,160
You can right click send to repeater and it's going to have this request.

63
00:04:03,220 --> 00:04:08,890
If I forward, this is going to do it ID four sorry, 85 for what he did it for which belong to the

64
00:04:08,890 --> 00:04:09,880
same house on the left.

65
00:04:10,540 --> 00:04:12,370
I'm going to drop this.

66
00:04:12,920 --> 00:04:13,600
Go back to it.

67
00:04:13,630 --> 00:04:14,800
Our address is still there.

68
00:04:15,430 --> 00:04:15,880
Stop.

69
00:04:15,920 --> 00:04:16,780
Go back to repeater.

70
00:04:17,800 --> 00:04:20,560
So again, we're just saying, hey, 85.

71
00:04:20,560 --> 00:04:21,760
This is 85 for us.

72
00:04:21,790 --> 00:04:25,480
If I send this in and refresh that, I just was gone as we expected.

73
00:04:25,510 --> 00:04:29,070
Now we want to see if we can delete other users addresses.

74
00:04:29,080 --> 00:04:35,200
So now that I know the others on the right side has a user has I just already we created it.

75
00:04:35,200 --> 00:04:36,130
We know the user ideas.

76
00:04:36,130 --> 00:04:39,690
Three, we know the address ID3 I'm going to change it.

77
00:04:39,700 --> 00:04:41,140
Three, push.

78
00:04:41,140 --> 00:04:46,570
OK, and since we have access to both users, what we can do in this case is we can go to our victim

79
00:04:46,570 --> 00:04:48,640
account, refresh and see if the object is still there.

80
00:04:48,830 --> 00:04:52,620
This case, it looks like there are no vulnerabilities here, which is very common.

81
00:04:52,630 --> 00:04:55,350
Not every functionality we look at is going to be vulnerable.

82
00:04:55,630 --> 00:05:00,750
I wanted to just demonstrate how I create data to test out whether a function is vulnerable or not.

83
00:05:01,060 --> 00:05:06,640
But now let's look at something that may be vulnerable and how we can exploit it for the case of this

84
00:05:06,640 --> 00:05:07,270
example.

85
00:05:07,300 --> 00:05:10,360
So what we're going to do now is we're going to make an order on here.

86
00:05:10,390 --> 00:05:12,010
Let's see what the ordering floor looks like.

87
00:05:12,020 --> 00:05:19,120
I'm going to add this hoodie into my cart and going to add at the basket and we're going to go to our

88
00:05:19,540 --> 00:05:22,030
cart and it says, add another address.

89
00:05:22,240 --> 00:05:23,470
We're going to add another one.

90
00:05:23,500 --> 00:05:29,770
We've done this already, but let's just do it one more time at this address.

91
00:05:30,490 --> 00:05:33,660
And now it says, please choose your address from your address book.

92
00:05:33,670 --> 00:05:35,410
So let's just see what this request looks like.

93
00:05:36,190 --> 00:05:38,730
I'm going to say I want to use Mister Test Test.

94
00:05:39,100 --> 00:05:43,990
And again, there's another I just ID here, but this time the request is being sent to basket and not

95
00:05:43,990 --> 00:05:44,650
an address book.

96
00:05:44,650 --> 00:05:46,150
So let's send this to the repeater.

97
00:05:46,690 --> 00:05:49,090
I'm going to drop it and we're going to look at it.

98
00:05:49,090 --> 00:05:55,690
==When you do this, it's going to give us the address for this particular ID numbers right here, says==

==99==
==00:05:55,840 --> 00:05:58,080==
==Tacitus, because we have 6.==

==100==
==00:05:58,090 --> 00:06:03,420==
==But what happens if we change this to address 3, which we know it's not our address ID, that's==

==101==
==00:06:03,430 --> 00:06:04,360==
==the other victims.==

==102==
==00:06:04,600 --> 00:06:06,370==
==And it comes back as Mister Test test.==

==103==
==00:06:06,610 --> 00:06:08,170==
==One, two, three, four, five.==

==104==
==00:06:08,440 --> 00:06:11,550==
==Fake street, fake city, four or four, seven, seven.==

==105==
==00:06:11,860 --> 00:06:14,530==
==Now we're going to look at our other account.==

==106==
==00:06:14,530 --> 00:06:15,310==
==This is a victim.==

==107==
==00:06:15,310 --> 00:06:21,310==
==We can confirm that this is the content that I put in here for the address book from the target user==

==108==
==00:06:21,310 --> 00:06:22,300==
==that I've created earlier.==

==109==
==00:06:22,510 --> 00:06:26,230==
==So in other words, right now we have confirmed that there is actually a vulnerability here.==

==110==
==00:06:26,440 --> 00:06:31,660==
==And by changing the address ID for when we selected Iris to ship our item to.==

==111==
==00:06:31,920 --> 00:06:37,780==
==So in other words, by having two accounts that we control, we know what the victims are, just ideas.==

==112==
==00:06:37,930 --> 00:06:43,720==
==We're going to swap it out and see if it gives us the same data as the victim using our own regular==

==113==
==00:06:43,720 --> 00:06:44,130==
==user.==

114
00:06:44,260 --> 00:06:48,850
So, again, it's very helpful to have both of these because you can exactly know what I had to go after

115
00:06:49,120 --> 00:06:53,530
and what to look for and confirm that that belongs to that user and so on.